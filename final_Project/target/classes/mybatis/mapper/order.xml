<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="orderMapper">

<select id="selectall" parameterType="orderdetail" resultType="orderdetail">
	SELECT *		 
	FROM order_detail 
	WHERE oid = #{oid}
</select>

<!-- 수정필요 -->

<select id="selectList" parameterType="order" resultType="order">
SELECT  id
        ,aid
        ,receiver
        ,address
        ,total
        ,to_char(pdate,'yyyy-mm-dd') AS pdate
        ,to_char(ddate,'yyyy-mm-dd') AS ddate
        ,status 
FROM ordered  
WHERE aid = #{aid}


</select>


<insert id="insertordered" parameterType="order">
INSERT INTO ordered (id,aid,receiver,address,total,pdate,ddate)
VALUES(ordered_seq.NEXTVAL,#{aid},#{receiver},#{address},#{total},SYSDATE,SYSDATE+1)

</insert>
	
<select id="selectone" parameterType="order" resultType="order">
select * 
from ordered 
where aid = #{aid} AND to_char(pdate, 'yyyymmdd' ) = to_char(sysdate, 'yyyymmdd')
</select>	

<insert id="insertorderdetail" parameterType="orderdetail">

INSERT INTO ORDER_DETAIL (id,oid,pid,qty,price)
VALUES (ORDER_DETAIL_SEQ.NEXTVAL, #{oid},#{pid},#{qty},#{price})


</insert>

	
</mapper>